ğŸ—ï¸ The core check is inside scheduleUpdateOnFiber
It does:

1ï¸âƒ£ Determine what phase youâ€™re in:
Is React in the render phase?
â†’ currentlyRenderingFiber is set, renderLanes are active.
Or are you in passive effects, an event, or async code?
â†’ renderLanes are empty, no synchronous work loop is running.

2ï¸âƒ£ Decide:
If youâ€™re in render:
React must cancel current work & restart â†’ immediate flush.
If youâ€™re outside render:
React sets a bit on the root: â€œneeds updateâ€
Schedules work on the scheduler for later.
âœ… So the decision point is when scheduleUpdateOnFiber runs.

