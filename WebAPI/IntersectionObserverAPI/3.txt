<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IntersectionObserver Restore State</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 0 20px;
    }
    .box {
      height: 100px;
      margin: 50px 0;
      background: lightblue; /* default state */
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      transition: background 0.3s;
    }
  </style>
</head>
<body>

  <div class="box" id="box1">Box 1</div>
  <div class="box" id="box2">Box 2</div>
  <div class="box" id="box3">Box 3</div>
  <div class="box" id="box4">Box 4</div>
  <div class="box" id="box5">Box 5</div>
  <div class="box" id="box6">Box 6</div>
  <div class="box" id="box7">Box 7</div>
  <div class="box" id="box8">Box 8</div>

  <script>
    const boxes = document.querySelectorAll(".box");

    // Define actions for visible state
    const actions = {
      box1: el => el.style.background = "lightgreen",
      box2: el => el.style.background = "lightcoral",
      box3: el => el.style.background = "lightgoldenrodyellow",
      box4: el => el.style.background = "lightskyblue",
      box5: el => el.style.background = "plum",
      box6: el => el.style.background = "khaki",
      box7: el => el.style.background = "orange",
      box8: el => el.style.background = "lightseagreen",
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const id = entry.target.id;

        if (entry.isIntersecting) {
          // When visible → apply custom action
          if (actions[id]) actions[id](entry.target);
          console.log(`${id} entered viewport`);
        } else {
          // When not visible → restore default state
          entry.target.style.background = "lightblue";
          console.log(`${id} left viewport`);
        }
      });
    }, { threshold: 0.5 });

    boxes.forEach(box => observer.observe(box));
  </script>
</body>
</html>
